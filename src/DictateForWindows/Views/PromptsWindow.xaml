<?xml version="1.0" encoding="utf-8"?>
<Window
    x:Class="DictateForWindows.Views.PromptsWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:DictateForWindows.Views"
    Title="Manage Prompts">

    <Grid Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Title bar -->
        <Grid Grid.Row="0" Padding="16" Background="{ThemeResource LayerFillColorDefaultBrush}">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <TextBlock
                Grid.Column="0"
                Text="Manage Prompts"
                Style="{StaticResource TitleTextBlockStyle}"/>

            <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="8">
                <Button
                    x:Name="ImportButton"
                    Click="OnImportClick"
                    ToolTipService.ToolTip="Import prompts">
                    <FontIcon Glyph="&#xE8B5;" FontSize="16"/>
                </Button>
                <Button
                    x:Name="ExportButton"
                    Click="OnExportClick"
                    ToolTipService.ToolTip="Export prompts">
                    <FontIcon Glyph="&#xEDE1;" FontSize="16"/>
                </Button>
            </StackPanel>
        </Grid>

        <!-- Prompts list -->
        <ListView
            Grid.Row="1"
            x:Name="PromptsListView"
            SelectionMode="None"
            Padding="16">
            <ListView.ItemTemplate>
                <DataTemplate>
                    <Grid Padding="12" Margin="0,4" CornerRadius="6"
                          Background="{ThemeResource CardBackgroundFillColorDefaultBrush}">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <StackPanel Grid.Column="0" Spacing="4">
                            <TextBlock
                                Text="{Binding Name}"
                                FontWeight="SemiBold"
                                FontSize="14"/>
                            <TextBlock
                                Text="{Binding Prompt}"
                                Style="{StaticResource CaptionTextBlockStyle}"
                                Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                TextTrimming="CharacterEllipsis"
                                MaxLines="2"/>

                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <TextBlock
                                    Text="Requires selection"
                                    FontSize="11"
                                    Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"
                                    Visibility="{Binding RequiresSelection}"/>
                                <TextBlock
                                    Text="Auto-apply"
                                    FontSize="11"
                                    Foreground="{ThemeResource SystemFillColorSuccessBrush}"
                                    Visibility="{Binding AutoApply}"/>
                            </StackPanel>
                        </StackPanel>

                        <StackPanel
                            Grid.Column="1"
                            Orientation="Horizontal"
                            Spacing="4"
                            VerticalAlignment="Center">
                            <Button
                                Click="OnEditPromptClick"
                                Tag="{Binding Id}"
                                Style="{StaticResource IconButtonStyle}"
                                ToolTipService.ToolTip="Edit">
                                <FontIcon Glyph="&#xE70F;" FontSize="14"/>
                            </Button>
                            <Button
                                Click="OnDeletePromptClick"
                                Tag="{Binding Id}"
                                Style="{StaticResource IconButtonStyle}"
                                ToolTipService.ToolTip="Delete">
                                <FontIcon Glyph="&#xE74D;" FontSize="14" Foreground="{StaticResource DictateErrorBrush}"/>
                            </Button>
                        </StackPanel>
                    </Grid>
                </DataTemplate>
            </ListView.ItemTemplate>
        </ListView>

        <!-- Add button -->
        <Button
            Grid.Row="2"
            x:Name="AddButton"
            Content="Add New Prompt"
            Click="OnAddPromptClick"
            HorizontalAlignment="Stretch"
            Margin="16"
            Style="{StaticResource AccentButtonStyle}"/>
    </Grid>
</Window>
